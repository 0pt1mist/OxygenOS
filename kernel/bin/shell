-- kernel/bin/shell
local fs = require("filesystem")

local function cmd_ls(args)
  local path = args[1] or "/"
  if not fs.exists(path) then
    print("ls: cannot access '" .. path .. "': No such file or directory")
    return
  end
  for item in fs.list(path) do
    print(item)
  end
end

while true do
  io.write("oxygen# ")
  local input = io.read()
  if not input then break end

  local words = {}
  for word in input:gmatch("%S+") do
    table.insert(words, word)
  end

  if #words == 0 then
    -- nothing brother
  elseif words[1] == "exit" then
    print("Shutting down...")
    os.exit()
  elseif words[1] == "ls" then
    cmd_ls({select(2, table.unpack(words))})
  elseif words[1] == "help" then
    print("Available commands: ls, help, exit")
  else
    print("oxygen: " .. words[1] .. ": command not found")
  end
end